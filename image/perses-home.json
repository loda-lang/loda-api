{
  "kind": "Dashboard",
  "metadata": {
    "name": "home"
  },
  "spec": {
    "display": {
      "name": "LODA Dashboard"
    },
    "datasources": {
      "influxdb": {
        "kind": "DatasourceSelector",
        "spec": {
          "name": "InfluxDB"
        }
      }
    },
    "duration": "6h",
    "refreshInterval": "30s",
    "layouts": [
      {
        "kind": "Grid",
        "spec": {
          "display": {
            "title": "Statistics",
            "collapse": {
              "open": true
            }
          },
          "items": [
            {
              "x": 0,
              "y": 0,
              "width": 4,
              "height": 3,
              "content": {
                "$ref": "#/spec/panels/total-programs"
              }
            },
            {
              "x": 4,
              "y": 0,
              "width": 4,
              "height": 3,
              "content": {
                "$ref": "#/spec/panels/new-programs"
              }
            },
            {
              "x": 8,
              "y": 0,
              "width": 4,
              "height": 3,
              "content": {
                "$ref": "#/spec/panels/updated-programs"
              }
            },
            {
              "x": 12,
              "y": 0,
              "width": 4,
              "height": 3,
              "content": {
                "$ref": "#/spec/panels/submitted-programs"
              }
            },
            {
              "x": 16,
              "y": 0,
              "width": 4,
              "height": 3,
              "content": {
                "$ref": "#/spec/panels/removed-programs"
              }
            },
            {
              "x": 20,
              "y": 0,
              "width": 4,
              "height": 3,
              "content": {
                "$ref": "#/spec/panels/formulas"
              }
            }
          ]
        }
      },
      {
        "kind": "Grid",
        "spec": {
          "display": {
            "title": "Activity",
            "collapse": {
              "open": true
            }
          },
          "items": [
            {
              "x": 0,
              "y": 0,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/programs-per-user"
              }
            },
            {
              "x": 12,
              "y": 0,
              "width": 12,
              "height": 8,
              "content": {
                "$ref": "#/spec/panels/active-miners"
              }
            }
          ]
        }
      }
    ],
    "panels": {
      "total-programs": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Total Programs",
            "description": "Total number of mined programs"
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last"
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "datasource": {
                  "$ref": "#/spec/datasources/influxdb"
                },
                "plugin": {
                  "kind": "InfluxDBQuery",
                  "spec": {
                    "query": "SELECT last(\"value\") FROM \"programs\" WHERE $timeFilter AND \"kind\" = 'total'"
                  }
                }
              }
            }
          ]
        }
      },
      "new-programs": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "New Programs",
            "description": "Number of new programs"
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last"
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "datasource": {
                  "$ref": "#/spec/datasources/influxdb"
                },
                "plugin": {
                  "kind": "InfluxDBQuery",
                  "spec": {
                    "query": "SELECT sum(\"value\") FROM \"programs\" WHERE $timeFilter AND \"kind\"='new'"
                  }
                }
              }
            }
          ]
        }
      },
      "updated-programs": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Updated Programs",
            "description": "Number of updated programs"
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last"
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "datasource": {
                  "$ref": "#/spec/datasources/influxdb"
                },
                "plugin": {
                  "kind": "InfluxDBQuery",
                  "spec": {
                    "query": "SELECT sum(\"value\") FROM \"programs\" WHERE $timeFilter AND \"kind\"='updated'"
                  }
                }
              }
            }
          ]
        }
      },
      "submitted-programs": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Submitted Programs",
            "description": "Number of submitted programs"
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last"
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "datasource": {
                  "$ref": "#/spec/datasources/influxdb"
                },
                "plugin": {
                  "kind": "InfluxDBQuery",
                  "spec": {
                    "query": "SELECT sum(\"value\") FROM \"programs\" WHERE $timeFilter AND \"kind\"='submitted'"
                  }
                }
              }
            }
          ]
        }
      },
      "removed-programs": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Removed Programs",
            "description": "Number of removed programs"
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last"
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "datasource": {
                  "$ref": "#/spec/datasources/influxdb"
                },
                "plugin": {
                  "kind": "InfluxDBQuery",
                  "spec": {
                    "query": "SELECT sum(\"value\") FROM \"programs\" WHERE $timeFilter AND \"kind\"='removed'"
                  }
                }
              }
            }
          ]
        }
      },
      "formulas": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Formulas",
            "description": "Total formulas"
          },
          "plugin": {
            "kind": "StatChart",
            "spec": {
              "calculation": "last"
            }
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "datasource": {
                  "$ref": "#/spec/datasources/influxdb"
                },
                "plugin": {
                  "kind": "InfluxDBQuery",
                  "spec": {
                    "query": "SELECT last(\"value\") FROM \"terms\" WHERE $timeFilter"
                  }
                }
              }
            }
          ]
        }
      },
      "programs-per-user": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Programs Per User"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "datasource": {
                  "$ref": "#/spec/datasources/influxdb"
                },
                "plugin": {
                  "kind": "InfluxDBQuery",
                  "spec": {
                    "query": "SELECT sum(\"value\") FROM \"programs\" WHERE $timeFilter GROUP BY time(1h),\"user\" fill(null)"
                  }
                }
              }
            }
          ]
        }
      },
      "active-miners": {
        "kind": "Panel",
        "spec": {
          "display": {
            "name": "Active Miners"
          },
          "plugin": {
            "kind": "TimeSeriesChart",
            "spec": {}
          },
          "queries": [
            {
              "kind": "TimeSeriesQuery",
              "spec": {
                "datasource": {
                  "$ref": "#/spec/datasources/influxdb"
                },
                "plugin": {
                  "kind": "InfluxDBQuery",
                  "spec": {
                    "query": "SELECT count(DISTINCT(\"user\")) FROM \"heartbeat\" WHERE $timeFilter GROUP BY time(1h) fill(null)"
                  }
                }
              }
            }
          ]
        }
      }
    }
  }
}
